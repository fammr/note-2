# [SQL注入原理以及如何避免注入](http://blog.csdn.net/jeofey/article/details/46987193)

### SQL注入原理

- 所谓SQL注入，就是通过把SQL命令插入到Web表单提交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令。
  - 具体来说，它是利用现有应用程序，将（恶意）的SQL命令注入到后台数据库引擎执行的能力，它可以通过在Web表单中输入（恶意）SQL语句得到一个存在安全漏洞的网站上的数据库，而不是按照设计者意图去执行SQL语句。
  - 比如先前的很多影视网站泄露VIP会员密码大多就是通过WEB表单递交查询字符暴出的，这类表单特别容易受到SQL注入式攻击。
- 根据相关技术原理，SQL注入可以分为平台层注入和代码层注入。
  - 前者由不安全的数据库配置或数据库平台的漏洞所致；
  - 后者主要是由于程序员对输入未进行细致地过滤，从而执行了非法的数据查询。
  - 基于此，SQL注入的产生原因通常表现在以下几方面：①不当的类型处理；②不安全的数据库配置；③不合理的查询集处理；④不当的错误处理；⑤转义字符处理不合适；⑥多个提交处理不当。

### 如何预防

1. 永远不要信任用户的输入。

   - 对用户的输入进行校验，可以通过正则表达式，或限制长度；
   - 对单引号和双"-"进行转换等。

2. 永远不要使用动态拼装sql，可以使用参数化的sql或者直接使用存储过程进行数据查询存取。

3. 永远不要使用管理员权限的数据库连接，为每个应用使用单独的权限有限的数据库连接。

4. 不要把机密信息直接存放，加密或者hash掉密码和敏感的信息。

5. 应用的异常信息应该给出尽可能少的提示，最好使用自定义的错误信息对原始错误信息进行包装。

6. 采用辅助软件或网站平台检测网站的SQL注入的漏洞。

   ​

   ​